(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();(function(){const r=sessionStorage.redirect;if(r){delete sessionStorage.redirect;const s="/mosaic3d/"+(r.startsWith("/")?r.substring(1):r);location.pathname!==s&&history.replaceState(null,"",s)}})();window.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed");const r="hasSeenMosaicMemoriesIntro",o=document.getElementById("intro-screen"),s=document.getElementById("get-started-btn"),i=[document.getElementById("canvas-container"),document.getElementById("joystick-container"),document.getElementById("look-area"),document.getElementById("addContentBtn"),document.getElementById("contentPanel")].filter(e=>e);function t(){console.log("Showing intro screen"),o&&o.classList.remove("hidden"),i.forEach(e=>{e.classList.add("hidden")})}function n(){console.log("Showing main app"),o&&o.classList.add("hidden"),i.forEach(e=>{e.classList.remove("hidden")}),g()}localStorage.getItem(r)?(console.log("User has seen intro, showing main app directly"),n()):(console.log("User has not seen intro, showing intro screen"),t(),s&&s.addEventListener("click",()=>{console.log("Get Started button clicked"),localStorage.setItem(r,"true"),n()}));function g(){console.log("Initializing app..."),console.log('Direct getElementById("canvas-container"):',document.getElementById("canvas-container")),console.log("Touch events supported:","ontouchstart"in window),document.body.addEventListener("touchstart",()=>{console.log("Body touchstart detected")},{passive:!0});function e(c){const d=document.getElementById(c);return console.log(`getEl called for id='${c}', found:`,d),d||console.error(`Element with id='${c}' not found!`),d}const f=e("canvas-container"),l=e("joystick-base"),u=e("joystick-handle"),m=e("look-area");e("addContentBtn");const p=e("contentPanel");e("contentTypeSelectView"),e("cameraModeView");const h=e("imagePreviewView");if(e("selectPhotoTypeBtn"),e("selectTextTypeBtn"),e("cameraPreview"),e("galleryInput"),e("galleryFromCamBtn"),e("captureFromCamBtn"),e("flipCameraBtn"),e("backToTypesBtn"),e("imagePreview"),e("pinPhotoBtn"),e("chooseDifferentBtn"),e("photoScaleSlider"),e("photoScaleValue"),e("reviewCreatorViewpointsBtn"),!f){console.error("Error: #canvas-container not found in DOM.");return}if(!l){console.error("Error: #joystick-base not found in DOM.");return}if(!u){console.error("Error: #joystick-handle not found in DOM.");return}if(!m){console.error("Error: #look-area not found in DOM.");return}closePanel(),updatePinButtonState(),[f,m,l,p,h].forEach(c=>{c&&c.addEventListener("contextmenu",function(d){})}),l&&u&&l.addEventListener("touchend",c=>{joystickDelta={x:0,y:0},u.style.transform="translate(-50%, -50%)"})}});
